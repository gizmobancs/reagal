<!DOCTYPE html>

<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HF03R5RLBZ"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HF03R5RLBZ');
  </script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>All Shows | Reagal Events</title>
<meta content="Browse all upcoming Reagal Events shows by town and date. Find your nearest circus tour stop and book tickets online." name="description"/>
<meta content="index, follow" name="robots"/>
<!-- Open Graph -->
<meta content="Reagal Events" property="og:site_name"/>
<meta content="en_GB" property="og:locale"/>
<meta content="All Shows | Reagal Events" property="og:title"/>
<meta content="Browse all upcoming Reagal Events shows by town and date. Find your nearest circus tour stop and book tickets online." property="og:description"/>
<meta content="website" property="og:type"/>
<meta content="https://reagalevents.com/banner1.jpg" property="og:image"/>
<!-- Twitter -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="All Shows | Reagal Events" name="twitter:title"/>
<meta content="Browse all upcoming Reagal Events shows by town and date. Find your nearest circus tour stop and book tickets online." name="twitter:description"/>
<meta content="https://reagalevents.com/banner1.jpg" name="twitter:image"/>
<link href="styles.css" rel="stylesheet"/>
<link crossorigin="" href="https://cdnjs.cloudflare.com" rel="preconnect"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/>
<script defer="" src="script.js"></script>
<link href="https://reagalevents.com/all-shows.html" rel="canonical"/><meta content="https://reagalevents.com/all-shows.html" property="og:url"/><link href="/favicon.ico" rel="icon" sizes="any"/><link href="/favicon-32.png" rel="icon" sizes="32x32" type="image/png"/><link href="/favicon-16.png" rel="icon" sizes="16x16" type="image/png"/><link href="/apple-touch-icon.png" rel="apple-touch-icon"/><link href="/site.webmanifest" rel="manifest"/><meta content="#0b0b0b" name="theme-color"/><link crossorigin="" href="https://www.googletagmanager.com" rel="preconnect"/><script data-seo="org" type="application/ld+json">{"@context": "https://schema.org", "@type": "Organization", "name": "Reagal Events", "url": "https://reagalevents.com", "logo": "https://reagalevents.com/favicon-512.png", "sameAs": ["https://www.facebook.com/reagalevents/", "https://www.tiktok.com/@reagalevents"]}</script></head>
<body>
<header>
<img alt="Reagal Events Banner" class="banner" src="banner1.jpg"/>
<h2 class="circus-font">Proudly Presents</h2>
<div class="banner2-container"></div>
<nav id="menu">
<ul>
<li><a href="index.html">Welcome</a></li>
<li><a href="all-shows.html">View All Shows</a></li>
<li><a href="/tour-locations">Tour Locations</a></li>
<li><a href="gallery.html">Gallery</a></li>
<li><a href="about-us.html">About Us</a></li>
<li><a href="contact.html">Contact Us</a></li>
<li><a href="general-tour.html">General Tour</a></li>
<li><a href="summer-season.html">Summer Season</a></li>
<li><a href="halloween-circus.html">Halloween Circus</a></li>
</ul>
</nav>
</header>
<!-- ✅ Title + description in the same shaded box style as the rest of the site -->
<section class="page-title-box">
<h1 class="all-shows-title">All Shows</h1>
<p class="all-shows-description">Discover all our exciting shows happening near you!</p>
</section>
<div id="events-container"></div>
<footer>
<div class="footer-container">
<div class="social-links">
<a class="social-icon" href="https://www.facebook.com/reagalevents" rel="noopener" target="_blank">
<i class="fa-brands fa-facebook-f"></i>
</a>
<a class="social-icon" href="https://www.tiktok.com/@the.wonder.circus" rel="noopener" target="_blank">
<i class="fa-brands fa-tiktok"></i>
</a>
</div>
<p class="footer-text">© 2025 Reagal Events. All rights reserved.</p>
<div class="ticketsource-button">
<a href="https://www.ticketsource.co.uk/reagalevents">
<img alt="Book now" border="0" height="56" src="https://www.ticketsource.co.uk/images/bookNow/bookNow-black-small.png" width="130"/>
</a>
</div>


<div class="footer-nap">
  <p><strong>Reagal Events</strong></p>
  <p><a href="tel:07719877422">07719 877422</a></p>
  <p>United Kingdom</p>
  <p>Animal licence number: 19/00613/AWEA</p>
</div>
</div>
</footer>
<script>
    async function fetchEvents() {
      try {
        const response = await fetch("/api/events");
        const eventsByTown = await response.json();
        displayEvents(eventsByTown);
      } catch (error) {
        console.error("Error fetching events:", error);
      }
    }

    function displayEvents(eventsByTown) {
      const container = document.getElementById("events-container");
      container.innerHTML = "";

      Object.entries(eventsByTown).forEach(([town, events]) => {
        if (!events || events.length === 0) return;

        // Combine all unique dates from all events in the town
        const allDates = events.flatMap((event) => event.dates || []);
        const uniqueDates = [...new Set(allDates.map((d) => d.date))];

        if (uniqueDates.length === 0) return;

        // Get "from" and "to" dates for the town
        const fromDate = uniqueDates[0];
        const toDate = uniqueDates[uniqueDates.length - 1];

        const event = events[0]; // Display details from the first event only

        const eventDiv = document.createElement("div");
        eventDiv.className = "event";

        // Thumbnail
        if (event.thumbnail) {
          const img = document.createElement("img");
          img.src = event.thumbnail;
          img.alt = event.eventName;
          img.className = "event-thumbnail";
          eventDiv.appendChild(img);
        }

        // Event details container
        const detailsDiv = document.createElement("div");
        detailsDiv.className = "event-details";

        // Event title with town and date range
        const title = document.createElement("h2");
        title.className = "event-title";
        title.textContent = `${event.eventName} (${town} - ${fromDate} to ${toDate})`;
        detailsDiv.appendChild(title);

        // Description
        const description = document.createElement("p");
        description.textContent = event.description;
        detailsDiv.appendChild(description);

        // Dropdown for selecting a date
        const dateDropdown = document.createElement("select");
        dateDropdown.className = "dropdown";
        dateDropdown.innerHTML = `<option value="">Select a date</option>`;
        uniqueDates.forEach((date) => {
          const option = document.createElement("option");
          option.value = date;
          option.textContent = date;
          dateDropdown.appendChild(option);
        });
        detailsDiv.appendChild(dateDropdown);

        // Dropdown for selecting a time
        const timeDropdown = document.createElement("select");
        timeDropdown.className = "dropdown";
        timeDropdown.innerHTML = `<option value="">Select a time</option>`;
        detailsDiv.appendChild(timeDropdown);

        // Update time dropdown based on selected date
        dateDropdown.addEventListener("change", () => {
          const selectedDate = dateDropdown.value;
          timeDropdown.innerHTML = `<option value="">Select a time</option>`;

          const filteredDates = allDates.filter((d) => d.date === selectedDate);
          filteredDates.forEach((d) => {
            const option = document.createElement("option");
            option.value = d.bookNowLink;
            option.textContent = d.time;
            timeDropdown.appendChild(option);
          });
        });

        // Book Now button
        const bookButton = document.createElement("a");
        bookButton.href = "#"; // Default, updated when a time is selected
        bookButton.target = "_blank";
        bookButton.textContent = "Book Now";
        bookButton.className = "book-button";
        detailsDiv.appendChild(bookButton);

        // Update book now button based on selected time
        timeDropdown.addEventListener("change", () => {
          bookButton.href = timeDropdown.value || "#";
        });

        eventDiv.appendChild(detailsDiv);
        container.appendChild(eventDiv);
      });
    }

    fetchEvents();
  </script>
</body>
</html>
